<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <title>Document</title>
</head>
<body>
  <!-- Google Fonts & Icons -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<nav class="navbar">
  <!-- Logo -->
  <div class="nav-left">
    <div class="logo">MyStore</div>
  </div>

  <!-- Search -->
  <div class="nav-center">
    <span class="material-icons search-icon">search</span>
    <input type="text" placeholder="Search for products..." />
  </div>

  <!-- Right -->
  <div class="nav-right">

    <!-- Categories -->
    <div class="nav-item category-wrapper">
      <span>Categories</span>
      <span class="material-icons">expand_more</span>

      <!-- Dropdown -->
      <div class="category-dropdown">
        <a href="/category/fashion">Fashion</a>
        <a href="/category/electronics">Electronics</a>
        <a href="/category/home">Home & Living</a>
        <a href="/category/beauty">Beauty</a>
      </div>
    </div>

    <div class="nav-item">
      <span class="material-icons">person</span>
      <span>Account</span>
    </div>

    <div class="nav-item">
      <span class="material-icons">shopping_cart</span>
      <span>Cart</span>
    </div>
  </div>
</nav>

<!-- Trending -->
<section class="product-section bg-light-blue">
  <div class="section-header">
    <h2>Trending Products</h2>
    <a href="/category/trending" class="view-more">
      View More <span class="material-icons">arrow_forward</span>
    </a>
  </div>

  <div class="product-row" id="trendingRow"></div>

</section>

<!-- Top Deals -->
<section class="product-section bg-light-yellow">
  <div class="section-header">
    <h2>Top Deals</h2>
    <a href="/deals" class="view-more">
      View More <span class="material-icons">arrow_forward</span>
    </a>
  </div>

  <div class="product-row" id="dealsRow"></div>
</section>

<!-- Suggested -->
<section class="product-section bg-light-green">
  <div class="section-header">
    <h2>Suggested For You</h2>
  </div>

  <div class="product-row" id="suggestedRow"></div>
</section>

<script src="api.js"></script>
<script>
  
const token = localStorage.getItem("token");

if (token) {
document.getElementById("profileBtn").style.display = "block";
}

document.getElementById("profileBtn").addEventListener("click", () => {
window.location.href = "dashboard.html";
});

  const BASE_URL = "https://my-store-w94t.onrender.com/api/products";

  async function loadTrending() {
const res = await fetch(`${BASE_URL}?limit=10`);
const data = await res.json();
renderProducts("trendingRow", data.products);
}

  async function loadTopDeals() {
const res = await fetch(`${BASE_URL}?limit=20`);
const data = await res.json();

const deals = data.products.filter(p => p.discount > 0);
renderProducts("dealsRow", deals.slice(0, 10));
}


  async function loadSuggested() {
const res = await fetch(`${BASE_URL}?limit=10`);
const data = await res.json();
renderProducts("suggestedRow", data.products);
}

  function renderProducts(containerId, products) {
const container = document.getElementById(containerId);
container.innerHTML = "";

products.forEach(p => {
  const discountPrice =
    p.discount > 0
      ? Math.round(p.price - (p.price * p.discount) / 100)
      : p.price;

  container.innerHTML += `
    <div class="product-card">
      <img src="${p.image?.url || '/placeholder.png'}" />

      <div class="product-info">
        <h4>${p.name}</h4>

        <div class="price">
          <span class="discounted">₹${discountPrice}</span>
          ${
            p.discount > 0
              ? `<span class="original">₹${p.price}</span>
                 <span class="off">${p.discount}% off</span>`
              : ""
          }
        </div>
      </div>
    </div>
  `;
});
}


  document.addEventListener("DOMContentLoaded", () => {
loadTrending();
loadTopDeals();
loadSuggested();
});

  
</script>
</body>
</html>
